# 1. 계층형 아키텍처의 문제는 무엇일까

계층형 아키텍처의 유일한 규칙은 특정한 계층에서 같은 계층 또는 아래 계층에만 접근 가능하다는 것이다.

### DB 주도 설계를 유도한다. (이해 안됨)

![image](https://user-images.githubusercontent.com/85796588/210202528-4257943d-76d7-4381-8c91-cb5f1114d38f.png)

웹 → 도메인 → 영속성 이 방식의 의존성 때문에 자연스래 영속성 계층을 토대로 작성된다.

원인은 ORM이다. 영속성 코드가 도메인에 녹아들어가 둘중 하나만 변경하기 어렵다. 이는 계층형 아키텍처의 장점과는 먼 얘기

비즈니스 관점에서 이 방법은 맞지 않다. **도메인 로직을 먼저** 만들고 검증한 뒤 이를 기반으로 웹과 영속성 계층을 만들어야 한다.

![image](https://user-images.githubusercontent.com/85796588/210202549-e0d69cf4-7814-4566-8909-33682cd48472.png)

계층형 아키텍처의 규칙을 편하게 지키기 위해 상위 컴포넌트들을 영속성 레이어에 위치시키게 된다.

### 테스트하기 어려워진다.

간단한 로직이라고 웹 계층(Contrller)에서 영속성 계층으로 바로 조작하는 경우가 있는데,
이는 추후에 어플리케이션에 책임이 섞이게 되니 건너뛰지 말자

추가적으로 mocking 해야할 계층이 하나 늘어난셈이다.

### 유스케이스를 숨긴다.

레이어 아키텍처는 도메인 서비스의 너비에 대해서는 규칙으로 강제하지 않는다.

따라서 도메인 서비스는 아주 많은 부분을 담당하는 넓은 서비스가 되는 경우가 있다.

의존성과 테스트 등 많은 문제가 생기니 유스케이스 단위로 나눠주자.

### 동시작업이 어렵다.

DB주도 설계가 된 경우는 엔티티 때문에 개별작업하기 힘들다.

그렇지 않은 경우더라도 넓은 서비스가 있다면, conflict를 야기한다.

### 그렇다면 정답은..?

정답은 없다. 여느 어플리케이션이든 시간이 지나면 품질이 저하되기 마련이다.

어떤 아키텍처를 사용하던지 몇가지 추가적인 규칙을 통해 엄격히 관리한다면 유지보수에 도움이 될 것이다.
